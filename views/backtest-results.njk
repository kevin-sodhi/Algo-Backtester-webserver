{% extends "base.njk" %}
{% from "partials/macros.njk" import metricsRow %}

{% block content %}
  <h1>{{ title }}</h1>

  <p><b>CSV:</b> {{ params.csv }}</p>
  <p><b>Fast MA:</b> {{ params.fast }} &nbsp; | &nbsp; <b>Slow MA:</b> {{ params.slow }}</p>

  <h3>Summary</h3>
  <table style="margin:1rem auto; border-collapse:collapse; min-width:360px;">
    <tbody>
      {{ metricsRow("Bars Read", metrics.barsRead) }}
      {{ metricsRow("Last Date", metrics.lastDate) }}
      {{ metricsRow("SMA Fast (last)", metrics.lastFast) }}
      {{ metricsRow("SMA Slow (last)", metrics.lastSlow) }}
      {{ metricsRow("Trades", metrics.trades) }}
      {{ metricsRow("Total Return %", metrics.totalReturnPct) }}
    </tbody>
  </table>

  {# Include signals; NO extra 'with {...}' here #}
  {% include "partials/signals.njk" %}

  <h3>Raw JSON</h3>
  <pre>{{ rawJson }}</pre>

  <p><a href="/">‚Üê Home</a></p>
{% endblock %}